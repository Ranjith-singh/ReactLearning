<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>chat bot</title>
</head>
<body>
    <div class="js-container"></div>

    <script src="https://unpkg.com/supersimpledev/react.js"></script>
    <script src="https://unpkg.com/supersimpledev/react-dom.js"></script>

    <script src="https://unpkg.com/supersimpledev/babel.js"></script>
    <script type="text/babel">

        const InputMessage= (props)=>{
            const {chats, setChats}= props
            const [inputValue, setInputValue]= React.useState('');
            
            const storeInput= (message, event)=>{
                // console.log(message);
                setInputValue(event.target.value);
            }
            const sendMessage= ()=>{
                setChats([
                    ...chats,
                    {
                        message: inputValue,
                        sender: 'user',
                        id: crypto.randomUUID()
                    }
                ])

                setInputValue('')
            }

            return (
            <>
                <input
                    id="message"
                    placeholder="type your query"
                    onChange= {(event)=>(storeInput("hello", event))}
                    value= {inputValue}
                    size="30"
                />
                <button
                    onClick={sendMessage}
                >
                    Send
                </button>
            </>
            )
        }

        const ChatMessage= ({message, sender})=>(
            <div>
                <p>
                    {sender === "robot" && (
                        <img
                            src="https://www.shutterstock.com/shutterstock/photos/2475457627/display_1500/stock-vector-robot-abstract-logo-modern-style-2475457627.jpg"
                            width= "40"
                        />
                    )}
                    {message}
                    {sender === "user" && (
                        <img
                            src="https://upload.wikimedia.org/wikipedia/commons/9/99/Sample_User_Icon.png" 
                            width="20"
                        />
                    )}
                </p>
            </div>
        )

        const ChatMessages= (props)=>{
            const {chats, setChats}= props;

            const submit= ()=>{
                // chats.push({
                //     message: "Will robot take over the World?",
                //     sender: "user",
                //     id: crypto.randomUUID()
                // })

                setChats([
                    ...chats,
                    {
                        message: "Will robot take over the World?",
                        sender: "user",
                        id: crypto.randomUUID()
                    }
                ])

                // console.log(chats)
            }

            return (
                <>
                    <button onClick={submit} >Submit</button>
                    {chats.map((chat)=>(
                        <ChatMessage
                            message={chat.message}
                            sender={chat.sender}
                            key= {chat.id}
                        />
                    ))}
                </>
            );

        }

        const App= ()=>{
            const [chats, setChats]= React.useState([
                {
                    message: "Hi, how are you?",
                    sender: "user",
                    id: '1'
                },
                {
                    message: "I am fine thanks for asking",
                    sender: "robot",
                    id: '2'
                },
                {
                    message: "roll a dice.",
                    sender: "user",
                    id: '3'
                },
                {
                    message: "Wow! you got 6",
                    sender: "robot",
                    id: '4'
                }
            ])
            return(
                <>
                    <InputMessage
                        chats= {chats}
                        setChats= {setChats}
                    />
                    <ChatMessages
                        chats= {chats}
                        setChats= {setChats}
                    />
                </>
            )
        };

        const container= document.querySelector(".js-container");
        ReactDOM.createRoot(container).render(<App />);
    </script>
</body>
</html>